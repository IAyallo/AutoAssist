<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>AutoAssist - Home</title>
    <link rel="stylesheet" href="style.css">
</head>
<body>
    <nav class="navbar">
        <div class="nav-logo">
            <div class="nav-logo-icon">
                <div class="tool-icon">
                    <div class="wrench"></div>
                    <div class="screwdriver"></div>
                </div>
            </div>
            <span class="nav-logo-text">AUTOASSIST</span>
        </div>
        <div class="nav-user">
            <button class="nav-btn" id="logout-btn">Logout</button>
            <div class="nav-avatar" id="user-avatar"></div>
        </div>
    </nav>

    <div class="container home-container">
        <div class="home-header">
            <h2 id="welcome-message">Welcome</h2>
            <p>What service do you need today?</p>
        </div>

        <div class="card">
            <h3 class="card-title">
                <span class="icon" style="mask-image: url('data:image/svg+xml,%3Csvg xmlns=\'http://www.w3.org/2000/svg\' viewBox=\'0 0 24 24\' fill=\'none\' stroke=\'currentColor\' stroke-width=\'2\' stroke-linecap=\'round\' stroke-linejoin=\'round\'%3E%3Cpath d=\'M19 17h2c.55 0 1-.45 1-1v-3c0-.9-.7-1.7-1.5-1.9C18.7 10.3 16 10 16 10s-1.3-2-3-2H5c-.55 0-1 .45-1 1v3c0 .55.45 1 1 1h2\'%3E%3C/path%3E%3Ccircle cx=\'7\' cy=\'18\' r=\'2\'%3E%3C/circle%3E%3Cpath d=\'M9 18h6\'%3E%3C/path%3E%3Ccircle cx=\'17\' cy=\'18\' r=\'2\'%3E%3C/circle%3E%3C/svg%3E');"></span>
                My Car
            </h3>
            <p id="car-details">No car registered</p>
            <a href="car-register.html" class="link" style="display: inline-block; margin-top: 10px;">Edit car details</a>
        </div>

        <div class="card">
            <h3 class="card-title">
                <span class="icon" style="mask-image: url('data:image/svg+xml,%3Csvg xmlns=\'http://www.w3.org/2000/svg\' viewBox=\'0 0 24 24\' fill=\'none\' stroke=\'currentColor\' stroke-width=\'2\' stroke-linecap=\'round\' stroke-linejoin=\'round\'%3E%3Ccircle cx=\'12\' cy=\'12\' r=\'10\'%3E%3C/circle%3E%3Cpath d=\'M16 16s-1.5-2-4-2-4 2-4 2\'%3E%3C/path%3E%3Cline x1=\'9\' y1=\'9\' x2=\'9.01\' y2=\'9\'%3E%3C/line%3E%3Cline x1=\'15\' y1=\'9\' x2=\'15.01\' y2=\'9\'%3E%3C/line%3E%3C/svg%3E');"></span>
                Request Service
            </h3>
            <p>Need help with your car? Request a mechanic now.</p>
            <a href="service-request.html" class="btn btn-primary" style="margin-top: 15px;">Request Service</a>
        </div>

        <div class="card">
            <h3 class="card-title">
                <span class="icon" style="mask-image: url('data:image/svg+xml,%3Csvg xmlns=\'http://www.w3.org/2000/svg\' viewBox=\'0 0 24 24\' fill=\'none\' stroke=\'currentColor\' stroke-width=\'2\' stroke-linecap=\'round\' stroke-linejoin=\'round\'%3E%3Cpath d=\'M14 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V8z\'%3E%3C/path%3E%3Cpolyline points=\'14 2 14 8 20 8\'%3E%3C/polyline%3E%3Cline x1=\'16\' y1=\'13\' x2=\'8\' y2=\'13\'%3E%3C/line%3E%3Cline x1=\'16\' y1=\'17\' x2=\'8\' y2=\'17\'%3E%3C/line%3E%3Cpolyline points=\'10 9 9 9 8 9\'%3E%3C/polyline%3E%3C/svg%3E');"></span>
                Service History
            </h3>
            <p>View your past service requests and receipts.</p>
            <a href="#" class="link" style="display: inline-block; margin-top: 10px;">View history</a>
        </div>
    </div>

    <script>
        // Check if car is registered
        if(localStorage.getItem('carRegistered') !== 'true') {
            window.location.href = 'car-register.html';
        }

        // Check if user is authenticated
        if(localStorage.getItem('isAuthenticated') !== 'true') {
            window.location.href = 'index.html';
        }

        // Show welcome message if redirected from registration
        const urlParams = new URLSearchParams(window.location.search);
        if(urlParams.has('welcome')) {
            const userName = localStorage.getItem('userName');
            alert(`Welcome to AutoAssist, ${userName}!`);
            // Remove the parameter from URL
            window.history.replaceState({}, document.title, "/home.html");
        }

        // Update displayed user info
        document.addEventListener('DOMContentLoaded', function() {
            const userName = localStorage.getItem('userName');
            const userInitials = userName ? userName.split(' ').map(n => n[0]).join('') : '';
            
            // Update avatar
            document.getElementById('user-avatar').textContent = userInitials;
            // Update welcome message
            document.getElementById('welcome-message').textContent = `Welcome, ${userName}`;
            
            // Update car info if available
            if(localStorage.getItem('carMake')) {
                const carMake = localStorage.getItem('carMake');
                const carModel = localStorage.getItem('carModel');
                const carYear = localStorage.getItem('carYear');
                const numberPlate = localStorage.getItem('numberPlate');
                
                document.getElementById('car-details').textContent = 
                    `${carMake} ${carModel} (${carYear}) - ${numberPlate}`;
            }

            // Logout button functionality
            document.getElementById('logout-btn').addEventListener('click', function() {
                localStorage.removeItem('isAuthenticated');
                localStorage.removeItem('userName');
                localStorage.removeItem('carRegistered');
                window.location.href = 'index.html';
            });
        });
    </script>
</body>
</html>